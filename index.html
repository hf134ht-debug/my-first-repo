<!DOCTYPE html>
<html lang="ja">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‡ºè·ç®¡ç† PWA</title>
<style>

/* ===== åŸºæœ¬è¨­å®š ===== */
body {
  font-family: "Arial", "ãƒ¡ã‚¤ãƒªã‚ª", sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(to bottom right, #e6f7d6, #f9ffd6);
  overflow-x: hidden;
}

/* èƒŒæ™¯ç”»åƒå¾©æ´» */
body::before {
  content: "";
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background-image: url('https://takatanouen.com/wp-content/uploads/2021/11/6f139b5aff6b0b56ebea56609d4ca516.png');
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
  opacity: 0.25;
  z-index: -1;
}

/* ===== ãƒšãƒ¼ã‚¸å…¨ä½“ã«ã‚¿ãƒ–åˆ†ã®ä½™ç™½ã‚’ç¢ºä¿ ===== */
#app {
  padding-bottom: 80px; /* â†ã‚¿ãƒ–é«˜ã•åˆ†ã®ä½™ç™½ */
}

/* ===== æœ€åˆã®ï¼”ãƒœã‚¿ãƒ³ç”»é¢ ===== */
#homeMenu {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  padding: 20px;
}

.menu-btn {
  background: #89c8ff;
  border-radius: 15px;
  padding: 30px 10px;
  text-align: center;
  font-size: 1.3em;
  font-weight: bold;
  color: white;
  box-shadow: 3px 3px 8px rgba(0,0,0,0.2);
  cursor: pointer;
  transition: transform 0.2s;
}

.menu-btn:hover {
  transform: scale(1.05);
}

/* ===== ã‚¿ãƒ–ï¼ˆãƒãƒƒãƒ—ãªè‰²ï¼‰ ===== */
#bottomTabs {
  position: fixed;
  bottom: 0; left: 0;
  width: 100%;
  display: flex;
  justify-content: space-around;
  background: #ffffff;
  border-top: 3px solid #ccc;
  box-shadow: 0 -3px 8px rgba(0,0,0,0.2);
  z-index: 100;
}

.tab-btn {
  flex: 1;
  padding: 12px 0;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
}

.tab-btn[data-tab="shipment"] { background:#8BC34A; color:white; }
.tab-btn[data-tab="history"] { background:#FFB74D; color:white; }
.tab-btn[data-tab="summary"] { background:#4FC3F7; color:white; }
.tab-btn[data-tab="sales"] { background:#FF8A80; color:white; }

.tab-btn.active {
  filter: brightness(0.85);
}

/* ===== å‡ºè·å…¥åŠ›ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå¾©å…ƒ ===== */
#shipmentContainer {
  padding: 20px;
}

label {
  font-size: 1.1em;
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

input, select, button {
  width: 100%;
  padding: 12px;
  font-size: 1.1em;
  border-radius: 8px;
  border: 1px solid #aaa;
  margin-top: 5px;
}

.item-button {
  flex: 1 1 45%;
  padding: 15px;
  font-size: 1.2em;
  background: #e0f0b8;
  border-radius: 10px;
  margin: 5px;
  text-align:center;
  border: 2px solid #3b7d32;
}

/* é¸æŠæ™‚ã®è‰² */
.item-ç™½èœ.selected { background-color:#a3c940; color:white; }
.item-ç™½èœã‚«ãƒƒãƒˆ.selected { background-color:#b7d875; color:white; }
.item-ã‚­ãƒ£ãƒ™ãƒ„.selected { background-color:#4caf50; color:white; }
.item-ã‚­ãƒ£ãƒ™ãƒ„ã‚«ãƒƒãƒˆ.selected { background-color:#66bb6a; color:white; }
.item-ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·.selected { background-color:#ffd700; color:white; }

</style>
</head>
<body>

<div id="app">

<!-- ğŸŒŸ æœ€åˆã®4ãƒœã‚¿ãƒ³ç”»é¢ -->
<div id="homeScreen">
  <h2 style="text-align:center; padding-top:20px;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>

  <div id="homeMenu">
    <div class="menu-btn" onclick="showTab('shipment')">å‡ºè·</div>
    <div class="menu-btn" onclick="showTab('history')">å±¥æ­´</div>
    <div class="menu-btn" onclick="showTab('summary')">é›†è¨ˆ</div>
    <div class="menu-btn" onclick="showTab('sales')">å£²ä¸Š</div>
  </div>
</div>

<!-- ğŸ”„ ã‚¿ãƒ–ã§åˆ‡ã‚Šæ›¿ãˆã‚‹å†…å®¹ -->
<main id="tabContent" style="display:none;"></main>

</div>

<!-- ğŸ”½ ä¸‹ã‚¿ãƒ–ï¼ˆç‹¬ç«‹ã—ãŸå›ºå®šãƒãƒ¼ï¼‰ -->
<div id="bottomTabs">
  <div class="tab-btn" data-tab="shipment">å‡ºè·</div>
  <div class="tab-btn" data-tab="history">å±¥æ­´</div>
  <div class="tab-btn" data-tab="summary">é›†è¨ˆ</div>
  <div class="tab-btn" data-tab="sales">å£²ä¸Š</div>
</div>

<script>
/* â˜…â˜… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆPOSTå…ˆ URL â˜…â˜… */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzK497D-jhTqBKZs07bpcU1-DC4y5jmZIpYhFlfK9MXuvOrhz2jGuGppSNqxSNvwsWdNg/exec";

/* æœ€åˆã¯ãƒ›ãƒ¼ãƒ ç”»é¢ã‚’è¡¨ç¤º */
function showHome(){
  document.getElementById("homeScreen").style.display="block";
  document.getElementById("tabContent").style.display="none";
}

/* ã‚¿ãƒ–æŠ¼ã—ãŸã‚‰ãƒ•ã‚©ãƒ¼ãƒ ã¸ */
function showTab(tab){
  document.getElementById("homeScreen").style.display="none";
  document.getElementById("tabContent").style.display="block";

  document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
  document.querySelector(`.tab-btn[data-tab="${tab}"]`).classList.add("active");

  if(tab==="shipment") loadShipmentPage();
  else document.getElementById("tabContent").innerHTML=`<h2>${tab}ï¼ˆé–‹ç™ºä¸­ï¼‰</h2>`;
}

/* ===== å‡ºè·ãƒšãƒ¼ã‚¸ç”Ÿæˆ ===== */
function loadShipmentPage(){
  const today=new Date().toISOString().slice(0,10);

  document.getElementById("tabContent").innerHTML=`
  <div id="shipmentContainer">
    <label>æ—¥ä»˜</label>
    <input type="date" id="date" value="${today}">
    
    <label>å“ç›®</label>
    <div style="display:flex; flex-wrap:wrap;">
      <div class="item-button item-ç™½èœ" data-value="ç™½èœ">ç™½èœ</div>
      <div class="item-button item-ç™½èœã‚«ãƒƒãƒˆ" data-value="ç™½èœã‚«ãƒƒãƒˆ">ç™½èœã‚«ãƒƒãƒˆ</div>
      <div class="item-button item-ã‚­ãƒ£ãƒ™ãƒ„" data-value="ã‚­ãƒ£ãƒ™ãƒ„">ã‚­ãƒ£ãƒ™ãƒ„</div>
      <div class="item-button item-ã‚­ãƒ£ãƒ™ãƒ„ã‚«ãƒƒãƒˆ" data-value="ã‚­ãƒ£ãƒ™ãƒ„ã‚«ãƒƒãƒˆ">ã‚­ãƒ£ãƒ™ãƒ„ã‚«ãƒƒãƒˆ</div>
      <div class="item-button item-ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·" data-value="ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·">ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·</div>
    </div>

    <label>å€¤æ®µ</label>
    <input type="number" id="price" min="0">

    <label>åº—èˆ—</label>
    <select id="store">
      <option value="é€£å³¶">é€£å³¶</option>
      <option value="æ´¥é«˜">æ´¥é«˜</option>
      <option value="èŒ¶å±‹ç”º">èŒ¶å±‹ç”º</option>
      <option value="å¤§å®‰å¯º">å¤§å®‰å¯º</option>
      <option value="ä¸­åº„">ä¸­åº„</option>
      <option value="ç·ç¤¾å—">ç·ç¤¾å—</option>
      <option value="å††å±±">å††å±±</option>
      <option value="å…å³¶">å…å³¶</option>
    </select>

    <label>å€‹æ•°</label>
    <input type="number" id="quantity" min="1">

    <button onclick="submitShipment()">ç™»éŒ²</button>
  </div>
  `;

  /* å“ç›®ã‚¯ãƒªãƒƒã‚¯å‡¦ç† */
  document.querySelectorAll(".item-button").forEach(btn=>{
    btn.addEventListener("click",()=>{
      document.querySelectorAll(".item-button").forEach(b=>b.classList.remove("selected"));
      btn.classList.add("selected");
    });
  });
}

/* ===== ç™»éŒ²é€ä¿¡å‡¦ç† ===== */
async function submitShipment(){
  const item=document.querySelector(".item-button.selected");
  if(!item){ alert("å“ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„"); return;}

  const data={
    date: document.getElementById("date").value,
    item: item.dataset.value,
    price: Number(document.getElementById("price").value),
    stores:[{
      name: document.getElementById("store").value,
      quantity: Number(document.getElementById("quantity").value)
    }]
  };

  try{
    await fetch(SCRIPT_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(data),
      mode:"no-cors"
    });
    alert("ç™»éŒ²ã—ã¾ã—ãŸï¼");
  } catch(e){
    alert("é€šä¿¡ã‚¨ãƒ©ãƒ¼:"+e);
  }
}

/* ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«ãƒ›ãƒ¼ãƒ ã‚’è¡¨ç¤º */
showHome();

</script>
</body>
</html>
